# ๐ ุงููุธุงู ุงูุดุงูู ูููุฑุงุณูุงุช - ุงูุฏููู ุงููุงูู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ูุฑุงุณูุงุช ุดุงูู ููุชูุงูู ูุฑุจุท ุฌููุน ุฃููุงุน ุงููุณุชุฎุฏููู ูู ููุตุฉ ูุฑุฉ ุงููุฏูุ ุจูุง ูู ุฐูู:

- **๐๏ธ ุงููุดุฑููู (Admin)**: ูุฑุงูุจุฉ ููุฑุงุณูุฉ ุฌููุน ุงููุณุชุฎุฏููู
- **๐ ุงูุฃูุฏูุฉ**: ุงูุชูุงุตู ูุน ุงููุงุนุจูู ูุงููููุงุก ูุงูุฃูุงุฏูููุงุช
- **โฝ ุงููุงุนุจูู ุงููุณุชูููู**: ุงูุจุญุซ ูุงูุชูุงุตู ูุน ุงููุฑุต
- **๐ค ุงููุงุนุจูู ุงูุชุงุจุนูู**: ุชุญุช ุฅุฏุงุฑุฉ ุงูุฃูุฏูุฉุ ุงููููุงุกุ ุงูุฃูุงุฏูููุงุชุ ูุงููุฏุฑุจูู
- **๐ฏ ุงููููุงุก**: ุฅุฏุงุฑุฉ ูุงุนุจููู ูุงูุชูุงุตู ูุน ุงูุฃูุฏูุฉ
- **๐ ุงูุฃูุงุฏูููุงุช**: ุชุฏุฑูุจ ูุฅุฏุงุฑุฉ ุงููุงุนุจูู ุงููุงุดุฆูู
- **๐ช ุงููุฏุฑุจูู**: ุงูุชูุงุตู ูุน ุงููุงุนุจูู ูุชุทููุฑ ูุฏุฑุงุชูู

---

## ๐ฏ ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. ๐ ูุฑุงุณูุงุช ูู ุงูููุช ุงููุนูู
- **Firebase Firestore**: ุชุญุฏูุซุงุช ูุจุงุดุฑุฉ ููุฑุณุงุฆู
- **ุฅุดุนุงุฑุงุช ููุฑูุฉ**: ุชูุจููุงุช ููุฑุณุงุฆู ุงูุฌุฏูุฏุฉ
- **ุญุงูุฉ ุงููุฑุงุกุฉ**: โ ููุฑูุกุฉ / โณ ุบูุฑ ููุฑูุกุฉ
- **ุชุชุจุน ุงููุดุงุท**: ุขุฎุฑ ุธููุฑ ููุดุงุท ุงููุณุชุฎุฏููู

### 2. ๐ ุฑุจุท ุดุงูู ุจูู ุฌููุน ุงูุญุณุงุจุงุช
- **๐๏ธ ุงูุฃุฏูู**: ูุตูู ูุงูู ูุฌููุน ุงููุญุงุฏุซุงุช ูุงููุณุชุฎุฏููู
- **ุงููุงุนุจูู ุงููุณุชูููู**: ุญุณุงุจุงุช ูููุตูุฉ ูู Firebase
- **ุงููุงุนุจูู ุงูุชุงุจุนูู**: ููุฏุงุฑูู ุชุญุช ุญุณุงุจุงุช ุงููุคุณุณุงุช
- **ุชุจุงุฏู ุงูุฑุณุงุฆู**: ุจูู ุฌููุน ุงูุฃุทุฑุงู ุจุฏูู ูููุฏ

### 3. ๐จ ูุงุฌูุฉ ูุฎุตุตุฉ ููู ููุน ูุณุชุฎุฏู
- **๐ ุงูุฃูุฏูุฉ**: ููู ุฃุฎุถุฑุ ุฃููููุฉ ุงููุจูู
- **โฝ ุงููุงุนุจูู**: ููู ุฑูุงุฏูุ ุฃููููุฉ ุงููุณุชุฎุฏููู
- **๐ฏ ุงููููุงุก**: ููู ุจุฑุชูุงููุ ุฃููููุฉ ุงููุงุชู
- **๐ ุงูุฃูุงุฏูููุงุช**: ููู ุจููุณุฌูุ ุฃููููุฉ ุงูุชุฎุฑุฌ
- **๐ช ุงููุฏุฑุจูู**: ููู ุฃุฒุฑูุ ุฃููููุฉ ุงููุฏุฑุจ
- **๐๏ธ ุงููุดุฑููู**: ููู ุฃุญูุฑุ ุฃููููุฉ ุงูุฏุฑุน

### 4. ๐ ุชูุงูู ูุน ุตูุญุงุช ุงูุจุญุซ
- **ุฃุฒุฑุงุฑ ูุฑุงุณูุฉ**: ูู ุฌููุน ูุชุงุฆุฌ ุงูุจุญุซ
- **ุฅุฑุณุงู ุณุฑูุน**: ูุงูุฐุฉ ุญูุงุฑ ูุฎุตุตุฉ
- **ุชูุฌูู ุชููุงุฆู**: ูุตูุญุฉ ุงูุฑุณุงุฆู ุจุนุฏ ุงูุฅุฑุณุงู

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช (Firebase Firestore)

#### ๐ Collections ุงูุฑุฆูุณูุฉ

```javascript
// 1. messages - ุงูุฑุณุงุฆู ุงููุฑุฏูุฉ
{
  id: string,
  conversationId: string,
  senderId: string,
  receiverId: string,
  senderName: string,
  receiverName: string,
  senderType: 'club' | 'player' | 'agent' | 'academy' | 'trainer' | 'admin',
  receiverType: 'club' | 'player' | 'agent' | 'academy' | 'trainer' | 'admin',
  message: string,
  timestamp: Timestamp,
  isRead: boolean,
  messageType: 'text' | 'image' | 'file',
  attachments?: string[],
  createdAt: Timestamp
}

// 2. conversations - ุงููุญุงุฏุซุงุช
{
  id: string,
  participants: string[],
  participantNames: Record<string, string>,
  participantTypes: Record<string, string>,
  subject: string,
  lastMessage: string,
  lastMessageTime: Timestamp,
  lastSenderId: string,
  unreadCount: Record<string, number>,
  isActive: boolean,
  createdAt: Timestamp
}

// 3. messaging_settings - ุฅุนุฏุงุฏุงุช ุงููุฑุงุณูุฉ
{
  userId: string,
  allowMessagesFrom: 'everyone' | 'connections' | 'nobody',
  blockedUsers: string[],
  autoReply: {
    enabled: boolean,
    message: string
  },
  notifications: {
    email: boolean,
    push: boolean,
    sound: boolean
  }
}
```

### ๐๏ธ ููููุงุช ุงููุธุงู

#### 1. MessageCenter.tsx
```typescript
// ุงููููู ุงูุฑุฆูุณู ูููุฑุงุณูุฉ
- ุนุฑุถ ูุงุฆูุฉ ุงููุญุงุฏุซุงุช
- ูุงุฌูุฉ ุฅุฑุณุงู ูุงุณุชูุจุงู ุงูุฑุณุงุฆู
- ุงูุจุญุซ ูู ุฌูุงุช ุงูุงุชุตุงู
- ุฅูุดุงุก ูุญุงุฏุซุงุช ุฌุฏูุฏุฉ
- ุฏุนู ุฎุงุต ููุฃุฏูู (ูุฑุงูุจุฉ ุฌููุน ุงููุญุงุฏุซุงุช)
```

#### 2. SendMessageButton.tsx
```typescript
// ุฒุฑ ูุฑุงุณูุฉ ูุงุจู ููุงุณุชุฎุฏุงู
- ูุธูุฑ ูู ุตูุญุงุช ุงูุจุญุซ ูุงูููุงุฆู
- ูุงูุฐุฉ ุญูุงุฑ ููุชุงุจุฉ ุงูุฑุณุงูุฉ
- ุฅูุดุงุก ูุญุงุฏุซุฉ ุชููุงุฆูุงู
- ุงูุชูุฌู ูุตูุญุฉ ุงูุฑุณุงุฆู
```

#### 3. MessageNotifications.tsx
```typescript
// ูุธุงู ุงูุฅุดุนุงุฑุงุช ูู ุงูููุฏุฑ
- ุนุฏุงุฏ ุงูุฑุณุงุฆู ุบูุฑ ุงูููุฑูุกุฉ
- ูุงุฆูุฉ ููุณุฏูุฉ ููุฅุดุนุงุฑุงุช
- ุฑูุงุจุท ุณุฑูุนุฉ ูููุญุงุฏุซุงุช
```

---

## ๐ ุชูุธูู ุงููููุงุช

```
src/
โโโ components/messaging/
โ   โโโ MessageCenter.tsx          # ุงููููู ุงูุฑุฆูุณู ูููุฑุงุณูุฉ
โ   โโโ SendMessageButton.tsx      # ุฒุฑ ุฅุฑุณุงู ุฑุณุงูุฉ
โ   โโโ MessageNotifications.tsx   # ุฅุดุนุงุฑุงุช ุงูููุฏุฑ
โ   โโโ MessagingSettings.tsx      # ุฅุนุฏุงุฏุงุช ุงููุฑุงุณูุฉ
โ
โโโ app/dashboard/
โ   โโโ admin/messages/page.tsx    # ุตูุญุฉ ุฑุณุงุฆู ุงูุฃุฏูู
โ   โโโ club/messages/page.tsx     # ุตูุญุฉ ุฑุณุงุฆู ุงููุงุฏู
โ   โโโ player/messages/page.tsx   # ุตูุญุฉ ุฑุณุงุฆู ุงููุงุนุจ
โ   โโโ agent/messages/page.tsx    # ุตูุญุฉ ุฑุณุงุฆู ุงููููู
โ   โโโ academy/messages/page.tsx  # ุตูุญุฉ ุฑุณุงุฆู ุงูุฃูุงุฏูููุฉ
โ   โโโ trainer/messages/page.tsx  # ุตูุญุฉ ุฑุณุงุฆู ุงููุฏุฑุจ
โ
โโโ components/shared/
    โโโ PlayersSearchPage.tsx      # ุตูุญุฉ ุงูุจุญุซ (ูุญุฏุซุฉ ุจุฃุฒุฑุงุฑ ุงูุฑุณุงุฆู)
```

---

## ๐ ุงูุฃูุงู ูุงูุตูุงุญูุงุช

### ููุงุนุฏ Firebase Security Rules

```javascript
// ููุฑุณุงุฆู
match /messages/{messageId} {
  allow read, write: if request.auth != null && (
    resource.data.senderId == request.auth.uid ||
    resource.data.receiverId == request.auth.uid ||
    isAdmin(request.auth.uid)
  );
}

// ูููุญุงุฏุซุงุช
match /conversations/{conversationId} {
  allow read, write: if request.auth != null && (
    request.auth.uid in resource.data.participants ||
    isAdmin(request.auth.uid)
  );
}

// ุฏุงูุฉ ูุญุต ุงูุฃุฏูู
function isAdmin(userId) {
  return exists(/databases/$(database)/documents/admins/$(userId));
}
```

### ๐ก๏ธ ูุณุชููุงุช ุงููุตูู

1. **๐๏ธ ุงููุดุฑู (Admin)**:
   - ูุฑุงูุจุฉ ุฌููุน ุงููุญุงุฏุซุงุช
   - ุฅุฑุณุงู ุฑุณุงุฆู ูุฌููุน ุงููุณุชุฎุฏููู
   - ุชุตุฏูุฑ ุจูุงูุงุช ุงููุฑุงุณูุฉ
   - ุฅุฏุงุฑุฉ ุงูุฑุณุงุฆู ุงููุจูุบ ุนููุง

2. **๐ฅ ุงููุณุชุฎุฏููู ุงูุนุงุฏููู**:
   - ุฑุคูุฉ ูุญุงุฏุซุงุชูู ุงูุดุฎุตูุฉ ููุท
   - ุฅุฑุณุงู ุฑุณุงุฆู ูุฌูุงุช ุงูุงุชุตุงู ุงููุชุงุญุฉ
   - ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ ุงูุดุฎุตูุฉ

---

## ๐ฎ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูููุดุฑููู ๐๏ธ

1. **ุงููุตูู ูููุธุงู**:
   ```
   /dashboard/admin/messages
   ```

2. **ุงููููุฒุงุช ุงูุฎุงุตุฉ**:
   - ุนุฑุถ ุฌููุน ุงููุญุงุฏุซุงุช ูู ุงููุธุงู
   - ูุฑุงูุจุฉ ุงููุญุชูู ุจุฏูู ุชุนุฏูู ุญุงูุฉ ุงููุฑุงุกุฉ
   - ุฅุฑุณุงู ุฑุณุงุฆู ูุฃู ูุณุชุฎุฏู
   - ุชุตุฏูุฑ ุชูุงุฑูุฑ ุงููุฑุงุณูุฉ

3. **ููุญุฉ ุงูุชุญูู**:
   - **๐ ุฅุญุตุงุฆูุงุช**: ุฅุฌูุงูู ุงูุฑุณุงุฆูุ ุงููุญุงุฏุซุงุช ุงููุดุทุฉุ ุฑุณุงุฆู ุงูููู
   - **๐ ููุงุชุฑ ูุชูุฏูุฉ**: ุญุณุจ ููุน ุงููุณุชุฎุฏูุ ุงูุญุงูุฉุ ุงูุชุงุฑูุฎ
   - **๐ ุชุจููุจุงุช**: ูุฑูุฒ ุงูุฑุณุงุฆูุ ุณุฌู ุงูุฑุณุงุฆูุ ุณุฌู ุงููุญุงุฏุซุงุช

### ููุฃูุฏูุฉ ๐

1. **ุฅุฏุงุฑุฉ ุงููุงุนุจูู**:
   - ุฒุฑ ุฑุณุงูุฉ ูู ูุงุฆูุฉ ุงููุงุนุจูู ุงููุณุฌููู
   - ุชูุงุตู ูุจุงุดุฑ ูุน ุงููุงุนุจูู ุงูุชุงุจุนูู

2. **ุงูุจุญุซ ูุงูุชูุธูู**:
   ```
   /dashboard/club/search-players
   ```
   - ูุฑุงุณูุฉ ุงููุงุนุจูู ุงููุณุชูููู
   - ุงูุชูุงุตู ูุน ุงููููุงุก ูุงูุฃูุงุฏูููุงุช

### ููุงุนุจูู โฝ

1. **ุงููุงุนุจูู ุงููุณุชูููู**:
   ```
   /dashboard/player/search
   ```
   - ุงูุจุญุซ ุนู ุงูุฃูุฏูุฉ ูุงููููุงุก
   - ุฅุฑุณุงู ุฑุณุงุฆู ูููุฑุต ุงููุชุงุญุฉ

2. **ุงููุงุนุจูู ุงูุชุงุจุนูู**:
   - ุงูุชูุงุตู ูุน ุงููุคุณุณุฉ ุงููุณุคููุฉ
   - ุงุณุชูุจุงู ุฑุณุงุฆู ูู ุงููุฑุต ุงูุฎุงุฑุฌูุฉ

### ูููููุงุก ๐ฏ

1. **ุฅุฏุงุฑุฉ ุงููุงุนุจูู**:
   ```
   /dashboard/agent/players
   ```
   - ูุฑุงุณูุฉ ุงููุงุนุจูู ุงููุณุฌููู ุชุญุชูู

2. **ุงูุจุญุซ ุนู ุงููุฑุต**:
   ```
   /dashboard/agent/search-players
   ```
   - ุงูุชูุงุตู ูุน ุงูุฃูุฏูุฉ ูุงูุฃูุงุฏูููุงุช

---

## ๐ง ุงูุชุฎุตูุต ูุงูุฅุนุฏุงุฏุงุช

### ุฅุนุฏุงุฏุงุช ุงููุฑุงุณูุฉ ูููุณุชุฎุฏู

```javascript
const defaultSettings = {
  allowMessagesFrom: 'everyone', // 'everyone' | 'connections' | 'nobody'
  blockedUsers: [],
  autoReply: {
    enabled: false,
    message: 'ุดูุฑุงู ูุฑุณุงูุชูุ ุณุฃุฑุฏ ุนููู ูุฑูุจุงู'
  },
  notifications: {
    email: true,
    push: true,
    sound: true
  }
}
```

### ุชุฎุตูุต ุงูุฃููุงู ูุงูุฃููููุงุช

```javascript
const USER_TYPES = {
  club: { 
    name: 'ูุงุฏู', 
    icon: Building2, 
    color: 'text-green-600',
    bgColor: 'bg-green-100'
  },
  player: { 
    name: 'ูุงุนุจ', 
    icon: Users, 
    color: 'text-gray-600',
    bgColor: 'bg-gray-100'
  },
  // ... ุจุงูู ุงูุฃููุงุน
}
```

---

## ๐ ุงูุชุญูููุงุช ูุงูุชูุงุฑูุฑ

### ูููุดุฑููู

1. **๐ ุฅุญุตุงุฆูุงุช ููููุฉ**:
   - ุนุฏุฏ ุงูุฑุณุงุฆู ุงููุฑุณูุฉ
   - ุงููุญุงุฏุซุงุช ุงููุดุทุฉ
   - ุฃูุซุฑ ุงููุณุชุฎุฏููู ูุดุงุทุงู

2. **๐ ุชูุงุฑูุฑ ุงููุญุชูู**:
   - ููุชุฑุฉ ุญุณุจ ููุน ุงููุณุชุฎุฏู
   - ุงูุจุญุซ ูู ูุญุชูู ุงูุฑุณุงุฆู
   - ุชุตุฏูุฑ ุงูุจูุงูุงุช ูู Excel/CSV

3. **๐ฏ ุชุญููู ุงูุงุณุชุฎุฏุงู**:
   - ุฃููุงุช ุงูุฐุฑูุฉ ูููุฑุงุณูุฉ
   - ุฃููุงุน ุงููุญุงุฏุซุงุช ุงูุฃูุซุฑ ุดููุนุงู
   - ูุนุฏู ุงูุงุณุชุฌุงุจุฉ

---

## ๐ ุงูุชุทููุฑุงุช ุงููุณุชูุจููุฉ

### ููุฏ ุงูุชุทููุฑ

1. **๐ ุงููุฑููุงุช**:
   - ุฅุฑุณุงู ุงูุตูุฑ ูุงููููุงุช
   - ูุนุงููุฉ ุงูุตูุฑ ุฏุงุฎู ุงููุญุงุฏุซุฉ
   - ุถุบุท ุงููููุงุช ุชููุงุฆูุงู

2. **๐ต ุงูููุงููุงุช ุงูุตูุชูุฉ**:
   - ููุงููุงุช ุตูุชูุฉ ูุจุงุดุฑุฉ
   - ุชุณุฌูู ุงูููุงููุงุช
   - ุฅุดุนุงุฑุงุช ุงูููุงููุงุช ุงููุงุฆุชุฉ

3. **๐ฅ ุงููุญุงุฏุซุงุช ุงูุฌูุงุนูุฉ**:
   - ุฅูุดุงุก ูุฌููุนุงุช
   - ุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก
   - ุฃุฏูุงุฑ ุงููุฌููุนุฉ

4. **๐ค ุงูุฐูุงุก ุงูุงุตุทูุงุนู**:
   - ุชุฑุฌูุฉ ุงูุฑุณุงุฆู ุงูุชููุงุฆูุฉ
   - ุงูุชุฑุงุญุงุช ุงูุฑุฏูุฏ ุงูุณุฑูุนุฉ
   - ุชุญููู ุงููุดุงุนุฑ

---

## ๐ ุงูุฎูุงุตุฉ

ุชู ุชุทููุฑ ูุธุงู ูุฑุงุณูุงุช ุดุงูู ููุชูุงูู ูุฑุจุท ุฌููุน ูุณุชุฎุฏูู ููุตุฉ ูุฑุฉ ุงููุฏู. ุงููุธุงู ูููุฑ:

- **๐ ุชูุงุตู ุณูุณ** ุจูู ุฌููุน ุฃููุงุน ุงููุณุชุฎุฏููู
- **๐๏ธ ุฅุฏุงุฑุฉ ูุงููุฉ** ูููุดุฑููู
- **โฝ ุชุฌุฑุจุฉ ูุฎุตุตุฉ** ููู ููุน ูุณุชุฎุฏู
- **๐ ุฅุดุนุงุฑุงุช ุฐููุฉ** ูู ุงูููุช ุงููุนูู
- **๐ ุฃูุงู ุนุงูู** ูุญูุงูุฉ ุงูุจูุงูุงุช

ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ููููู ุงูุชูุณุน ููู ุจุณูููุฉ ูุฅุถุงูุฉ ูููุฒุงุช ุฌุฏูุฏุฉ ูู ุงููุณุชูุจู.

---

*๐ ุขุฎุฑ ุชุญุฏูุซ: ุฏูุณูุจุฑ 2024*
*๐ง ุงููุทูุฑ: ูุฑูู ุชุทููุฑ ููุตุฉ ูุฑุฉ ุงููุฏู*
